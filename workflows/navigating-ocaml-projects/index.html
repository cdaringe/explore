<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
 <head><title>Navigating OCaml Projects</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta charset="utf-8"/>
  <meta name="description"
   content="Learn how to navigate and read OCaml projects to help you use and understand other projects"
   />
  <link rel="stylesheet"
   href="https://fonts.googleapis.com/css2?family=Roboto+Mono&amp;family=Ubuntu:ital,wght@0,400;0,700;1,400&amp;display=swap"
   />
  <link rel="stylesheet"
   href="https://unpkg.com/purecss@2.0.0/build/base.css"/>
  <link rel="stylesheet"
   href="https://unpkg.com/purecss@2.0.0/build/grids-core.css"/>
  <link rel="stylesheet"
   href="https://unpkg.com/purecss@2.0.0/build/grids-units.css"/>
  <link rel="stylesheet"
   href="https://unpkg.com/purecss@2.0.0/build/grids-responsive.css"/>
  <link rel="stylesheet"
   href="https://unpkg.com/purecss@2.0.0/build/menus-core.css"/>
  <link rel="stylesheet"
   href="https://unpkg.com/purecss@2.0.0/build/menus-dropdown.css"/>
  <link rel="stylesheet" href="/css/main.css"/>
  <link rel="stylesheet"
   href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.0/styles/gruvbox-dark.min.css"
   />
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js">
  </script>
  <script
   src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.0/highlight.min.js"
   >
  </script>
  <script charset="UTF-8"
   src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.0/languages/ocaml.min.js"
   >
  </script><script>hljs.initHighlightingOnLoad();</script>
 </head>
 <body>
             
  <header>
                  
   <a class="skip-to-content" href="#main"> Skip to main content </a>
   <div class="pure-g">
                             
    <div class="pure-u-1-3">
                                    
     <a class="title-link" href="/">
                                              
      <h2 style="text-align: center">Explore OCaml</h2>
                                                               
     </a>
               
    </div>
                
    <div class="pure-u-1-3"></div>
                                          
    <nav class="pure-hidden-xs pure-hidden-sm pure-u-1-3 flex-col flex-vert">
     
               
     <ul class="flex-row flex-center nav-ul">
      <li class="nav-button">
                                           
       <a href="/platform">
                                           Tools 
                                         </a>
       
                   
      </li>
      <li class="nav-button">
                                           
       <a href="/users">
                                        Users
                                      </a>
       
                   
      </li>
      <li class="nav-button">
                                           
       <a href="/libraries">
                                            Libraries
                                          </a>
       
                   
      </li>
     </ul>
                  
    </nav>
                  
    <nav class="pure-hidden-md pure-hidden-lg pure-hidden-xl pure-menu
     pure-menu-horizontal flex-col flex-vert pure-u-1-3">
                                                                   
     <ul class="pure-menu-list" style="text-align: center">
      <li class="pure-menu-item pure-menu-has-children pure-menu-allow-hover">
       
                   <a href="#" id="menuLink1" class="pure-menu-link">Menu</a>
       
                   
       <ul class="pure-menu-children mob-menu-list">
        <li class="pure-menu-item mob-menu-item">
                                                                   
         <a href="/platform">
                                                 Tools 
                                               </a>
         
                         
        </li>
        <li class="pure-menu-item mob-menu-item">
                                                                   
         <a href="/users">
                                              Users
                                            </a>
         
                         
        </li>
        <li class="pure-menu-item mob-menu-item">
                                                                   
         <a href="/libraries">
                                                Libraries
                                                
         </a>
                             
        </li>
       </ul>
                        
      </li>
     </ul>
                  
    </nav>
              
   </div>
               
  </header>
                   
  <div class="pure-g">
                                
   <div class="pure-u-1-12 pure-u-md-1-4">
                                                      
    <div class="pure-hidden-xs pure-hidden-sm pure-hidden-md toc-container
     sticky">
     <ul class="toc">
      <li>
       <ul class="toc">
        <li>
         <a class="toc-item-1" href="#navigating-ocaml-projects">
          Navigating OCaml Projects
         </a>
         <ul class="toc">
          <li><a class="toc-item-2" href="#overview">Overview</a></li>
         </ul>
         <ul class="toc">
          <li><a class="toc-item-2" href="#structure">Structure</a>
           <ul class="toc">
            <li>
             <a class="toc-item-3" href="#files-in-the-top-level-directory">
              Files in the top-level directory
             </a>
            </li>
           </ul>
           <ul class="toc">
            <li>
             <a class="toc-item-3" href="#directory-layout">Directory Layout
             </a>
            </li>
           </ul>
           <ul class="toc">
            <li>
             <a class="toc-item-3" href="#the-omnipresent-dune-file">
              The Omnipresent Dune File
             </a>
            </li>
           </ul>
          </li>
         </ul>
         <ul class="toc">
          <li>
           <a class="toc-item-2" href="#implementation-and-interfaces">
            Implementation and Interfaces
           </a>
          </li>
         </ul>
         <ul class="toc">
          <li>
           <a class="toc-item-2" href="#miscellaneous-files-and-directories">
            Miscellaneous Files and Directories
           </a>
          </li>
         </ul>
        </li>
       </ul>
      </li>
     </ul>
    </div>
                    
   </div>
                   
   <div class="pure-u-5-6 pure-u-md-1-2">
                                                     
    <main id="main"> 
     <h1 id="navigating-ocaml-projects">Navigating OCaml Projects</h1>
<p><em>Last Updated: 31, July 2020 at 03:05:12</em></p>
<hr />
<h2 id="overview">Overview</h2>
<hr />
<p>Looking at the root of an OCaml project can be intimidating - there can be many files and many directories. There are, however, some common standards and best practices that many OCaml libraries use. This workflow aims to help you navigate most OCaml projects.</p>
<h2 id="structure">Structure</h2>
<hr />
<h3 id="files-in-the-top-level-directory">Files in the top-level directory</h3>
<p>What follows are brief descriptions of files you will likely see in the top-level directory of the project (usually the first page you see when you open a project on Github) and what they do.</p>
<ul>
<li><code>Makefile</code> - <a href="https://www.gnu.org/software/make/manual/make.html#Introduction">make</a> is a build tool and the <code>Makefile</code> tells make what to do. Quite a few OCaml projects use a <code>Makefile</code> to wrap dune build commands, especially those with non-obvious arguments. Unless your project is complex you don't need a <code>Makefile</code> but it is useful to know why you might come across one.
</li>
<li><code>.gitignore</code> - a file that tells git which files or folders it should ignore. Some standard OCaml things you might consider ignoring are: <a href="/platform/dune">dune</a>'s build directory (<code>_build</code>), <a href="/pages/opam-client">local opam switches</a> (<code>_opam</code>) and <a href="/platform/merlin">merlin</a> files (<code>.merlin</code>).
</li>
<li><code>.ocamlformat</code> and <code>.ocp-indent</code> - these are configuration files for the <a href="https://github.com/ocaml-ppx/ocamlformat">OCamlFormat</a> and <a href="https://github.com/OCamlPro/ocp-indent">Ocp-indent</a> tools respectively. It will, at a bare minimum, a version number inside. For more information on setting this up see the <a href="/workflows/keeping-your-code-clean">relevant workflow</a>.
</li>
<li><code>dune-project</code> - a file which marks the root of the project. It will usually be generated for you whenever you run <code>dune build</code> for the first time. It contains a <a href="https://dune.readthedocs.io/en/stable/dune-files.html#dune-project">lang</a> stanza which tells dune what version you are using. It is also <a href="/workflows/initialising-a-new-library">recommended</a> that you generate your opam files from here.
</li>
<li><code>*.opam</code> or <code>opam</code> - these are <a href="/pages/opam-files">opam files</a> which contain project metadata and dependency information.
</li>
<li><code>*.opam.template</code> - not everything can be generated by your <code>dune-project</code> file for the opam file, the template file lets you add additional data like <code>pin-depends</code> for adding unreleased versions of packages.
</li>
<li><code>.travis.yml</code> and <code>appveyor.ml</code> - these are continuous integration configuration files for <a href="https://travis-ci.org/">TravisCI</a> and <a href="https://www.appveyor.com/">AppVeyor</a> respectively.
</li>
</ul>
<h3 id="directory-layout">Directory Layout</h3>
<p>How directories are laid-out for a project varies greatly depending on what is being built and who is building it - what follows is an attempt at describing the most general and common project structure. Our running example will be a library called <code>explore</code> that also makes a command-line tool.</p>
<p>Here is what a typical structure may look like.</p>
<pre><code>.
|-- bin
|   |-- cli.ml
|   `-- dune
|-- dune-project
|-- explore-unix.opam
|-- explore.opam
|-- lib
|   |-- explore
|   |   |-- dune
|   |   |-- explore.ml
|   |   |-- explore.mli
|   |   |-- files.ml
|   |   `-- files.mli
|   `-- explore-unix
|       |-- dune
|       |-- explore_unix.ml
|       `-- explore_unix.mli
`-- test
    |-- test.ml
    |-- test_files.ml
    `-- test_files.mli
</code></pre>
<p>There are three main directories:</p>
<ol>
<li><code>bin</code> - short for binaries, this is where the executables live. The <code>dune</code> file will likely be building an <a href="https://dune.readthedocs.io/en/stable/dune-files.html#executable">executable</a>.
</li>
<li><code>lib</code> - short for libraries, this is where code that other programs can use lives. The <code>dune</code> file will likely be building a <a href="https://dune.readthedocs.io/en/stable/dune-files.html#library">library</a>.
</li>
<li><code>test</code> - the testing of the project is done here. The <code>dune</code> file will likely be building a <a href="https://dune.readthedocs.io/en/stable/dune-files.html#test">test</a> suite. This can be a good place to see the project being used in practice if you are unsure how to use it.
</li>
</ol>
<p>You may have noticed there are two opam files, this is <a href="https://github.com/mirage/irmin">actually</a> <a href="https://github.com/ocsigen/lwt">quite</a> <a href="https://github.com/ocsigen/tyxml">common</a>. Sometimes you want highly dependent code to live in the same respository together like the main <code>explore</code> library and the unix implementation, <code>explore-unix</code>. Or maybe your library also has a <a href="/workflows/meta-programming-in-ocaml">ppx</a> that can be a separate opam package.</p>
<h3 id="the-omnipresent-dune-file">The Omnipresent Dune File</h3>
<p>Nearly every directory contains a <code>dune</code> file. Dune uses these to understand the structure of your project and build it appropriately. Running <code>dune runtest</code> for example knows to go looking in the <code>test</code> folder because the <code>dune</code> file in it has a <code>test</code> stanza. For more on this, check out the <a href="/platform/dune">dune</a> page.</p>
<h2 id="implementation-and-interfaces">Implementation and Interfaces</h2>
<p>OCaml is built around the idea of <a href="https://caml.inria.fr/pub/docs/manual-ocaml/moduleexamples.html#s:separate-compilation">compilation units</a>. Each unit being made up of an implementation (the <code>.ml</code> file) and an interface or specification (the <code>.mli</code> file). The interface is like the contractual obligation for what the implementation must provide.</p>
<p>This means the interface files is a good place to start looking if you are using a library or want to get a broad overview of how a project is structured. What types are abstracted (i.e. appear as just <code>type t</code> in the file), what submodules are defined etc. This information helps in knowing what you can and can't do.</p>
<p>It is also where most <a href="/workflows/documenting-your-project">documentation</a> is written and as you become more familiar with reading type information, it can be a very useful way to properly use someone's library.</p>
<p><a href="/platform/utop">Utop</a> offers good support for quickly inspecting other code, as does the <a href="/platform/visual-studio-code">VS Code platform</a>.</p>
<h2 id="miscellaneous-files-and-directories">Miscellaneous Files and Directories</h2>
<p>There are many different ways to structure an OCaml project, particularly when you are using Dune. What follows are a few more files and directories to look out for as you explore other OCaml projects.</p>
<ul>
<li><code>fuzz</code> and <code>bench</code> directories - these hold <a href="/workflows/fuzz-testing-your-project">fuzz tests</a> and <a href="profiling-your-project">benchmarks</a> respectively.
</li>
<li><code>doc</code> directory or <code>gh-pages</code> branch - either one of these may contain the result of producing documentation with the <a href="/libraries/odoc">odoc</a> tool. The <a href="/workflows/documenting-your-project">documentation workflow</a> explains how this works.
</li>
</ul>

     <h3>Resources</h3>
     <ol>
      <li>
       <a href="https://www.craigfe.io/posts/the-intf-trick">The intf trick
       </a> - 
       Craig Ferguson explains a different way of laying out OCaml
       compilation units to reduce duplication of type information and the
       tradeoffs associated with it. This is a technique commonly used by
       Jane Street in their OSS.
      </li>
     </ol>
    </main>
                     
   </div>
                 
  </div>
            
          
        </body>
</html>
